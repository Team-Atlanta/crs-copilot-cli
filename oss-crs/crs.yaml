name: crs-copilot-cli
type:
  - bug-fixing
version: 1.0.0
docker_registry: ghcr.io/team-atlanta/crs-copilot-cli

prepare_phase:
  hcl: oss-crs/docker-bake.hcl

target_build_phase:
  - name: default-build
    dockerfile: oss-crs/builder.Dockerfile
    outputs:
      - build
      - src
  - name: inc-builder-asan
    snapshot: true
    dockerfile: oss-crs-infra:default-builder
    additional_env:
      SANITIZER: address

crs_run_phase:
  patcher:
    dockerfile: oss-crs/patcher.Dockerfile
    additional_env:
      # Default values. To override, set additional_env in compose yaml.
      CRS_AGENT: copilot_cli
      # COPILOT_MODEL: gpt-5.3-codex  # Optional override (default if unset)
      # COPILOT_GITHUB_TOKEN: ""  # Optional GitHub token for Copilot CLI auth (recommended)
      # COPILOT_SUBSCRIPTION_TOKEN: ""  # Compatibility alias; COPILOT_GITHUB_TOKEN is preferred
      # AGENT_TIMEOUT: "0"  # seconds, 0 = no limit (default)
      # BUILDER_MODULE: "inc-builder-asan"  # Builder sidecar module (must match run_snapshot module name)
  inc-builder-asan:
    run_snapshot: true
    dockerfile: oss-crs-infra:default-builder

supported_target:
  mode:
    - full
    - delta
  language:  # language-agnostic â€” agent edits source, builder sidecar handles compilation
    - c
    - c++
    - jvm
  sanitizer:
    - address
    - undefined
  architecture:
    - x86_64

required_llms:
  # Copilot CLI uses simplified model IDs (not dated snapshots).
  # These must be available in the LiteLLM proxy.
  - gpt-5.3-codex            # default
